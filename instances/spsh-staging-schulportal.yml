apiVersion: 1.1

# Create this namespace beforehand? not sure whether it is created if not already present
#  we could also use a s3 bucket
storage:
  name: release-management
  type: kubernetes
  numberOfRevisions: 15

releases:
  spsh-init:
    chart: ./charts/spsh-init
    namespace: spsh
    kubeconfig: ~/spsh-app-deploy/.kube/config
    valueFiles: ~/spsh-app-deploy/config/helm_charts/staging/values.yml
    createNamespace: true
    wait: true 
  dbildungs_iam_keycloak:
    chart: dBildungsplattform/dbildungs-iam-keycloak
    chartVersion: 8.8.12
    namespace: spsh
    kubeconfig: ~/spsh-app-deploy/.kube/config
     # do we need a staging and a prod config? Probably yes?
     # multiple value filed prod/staging/all/instance/service
    valueFiles:
      - ~/spsh-app-deploy/config/helm_charts/dbildungs-iam-keycloak/values.yml
      - ~/spsh-app-deploy/config/helm_charts/staging/values.yml
    wait: true 
  schulportal_client:
    chart: dBildungsplattform/schulportal-client
    chartVersion: 8.8.12
    namespace: spsh
    kubeconfig: ~/spsh-app-deploy/.kube/config
    valueFiles:
      - ~/spsh-app-deploy/config/helm_charts/dbildungs-iam-client/values.yml

  dbildungs_iam_server:
    chart: dBildungsplattform/dbildungs-iam-server
    chartVersion: 8.8.12
    namespace: spsh
    kubeconfig: ~/spsh-app-deploy/.kube/config
    valueFiles:
      - ~/spsh-app-deploy/config/helm_charts/dbildungs-iam-server/values.yml
      - ~/spsh-app-deploy/config/helm_charts/staging/values.yml

repositories:
  dBildungsplattform: https://github.com/dBildungsplattform/helm-charts-registry